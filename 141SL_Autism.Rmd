---
title: "141SL Autism"
author: "Rose Din (ID: 804764627), Lisa Kaunitz (ID: 404731988), Claire Markey (ID: 104789928), Allison Ocelo (ID: 404799327), Cristina Sanchez (ID: 805119924), and Kayla Schroeder (ID: 804729436) - Section 1A"
date: "2/10/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=FALSE}
library(readr)
library(dplyr)
ChatterBabyData <- read_csv("ChatterBabyData.csv")
```

```{r}
# split the string
for (i in 1:nrow(ChatterBabyData)){
 ChatterBabyData$babysweightlbs[i] <- stringr::str_extract_all(as.character(ChatterBabyData$babysweightlbs[i]),"[[:digit:]]+")
}
# insert "." between character strings
for (i in 1:nrow(ChatterBabyData)){
ChatterBabyData$babysweightlbs[i] <- sapply(ChatterBabyData$babysweightlbs[i], paste, collapse = ".")
}
```


Cleaning/ Transforming the Data: 

- removing the `asdbehaviors` and `lostskillsdemographics` columns becuase they make up the outcome
- removing the baby language as a predictor 

```{r}
cbdata <- ChatterBabyData[,-c(1:7, 217:240)]
```



Transforming the weight from kg to pounds then cbind into the same column for lbs: 

```{r,warning=FALSE}
# Convert weight in kg to lbs then to character vector
cbdata$weightkg <- as.numeric(cbdata$weightkg)
cbdata$weightkg <- as.character(round(2.20462 * cbdata$weightkg,2))
rename(cbdata, weightlb = weightkg)

# replace the missing values in `babysweightlbs` with values from weightkg
cbdata <- cbdata %>% mutate(babysweightlbs=ifelse(babysweightlbs=="NA", weightkg, babysweightlbs))

# Convert to numeric
cbdata$babysweightlbs <- round(as.numeric(cbdata$babysweightlbs), 2)

# Convert all Colic NA's to 0: 
cbdata$colic[is.na(cbdata$colic)] <- 0 

# getting rid of the weightkg:
cbdata <- cbdata[,-c(5)]
```


# Columns we need to fix

# Cristina
otherrace

# Cleaning `deaffamily_other`

```{r}
cbdata$deaffamily_other <- tolower(cbdata$deaffamily_other)

cbdata$deaffamily_other <- str_replace_all(cbdata$deaffamily_other, "[^[:alnum:]]", "")

# classify relationship as aunt
cbdata$deaffamily_other[grepl("auntie|babysgreataunt", 
                            cbdata$deaffamily_other)] <- "aunt"

# classify relationship as uncle
cbdata$deaffamily_other[grepl("brotherofthefather|greatuncle|
maternalgreatuncledeafsincebirthbutetiologyunknownsuspectedcongenitalinfxny",
cbdata$deaffamily_other)] <- "uncle"

# classify relationship as grandmother
cbdata$deaffamily_other <-
  ifelse(cbdata$deaffamily_other == "gradmothermaternal" |
           cbdata$deaffamily_other == "gramotherpartiallossduetoshingels" |
           cbdata$deaffamily_other == "grandma" |
           cbdata$deaffamily_other == "grandmotheronfathersside" |
           cbdata$deaffamily_other == "maternalgrandmother" |
           cbdata$deaffamily_other == "paternalgrandma" |
           cbdata$deaffamily_other == "paternalgrandmother" |
           cbdata$deaffamily_other == "motheroffather" |
           cbdata$deaffamily_other == "greatgreatgrandma" |
           cbdata$deaffamily_other == "maternalgreatgrandma" |
           cbdata$deaffamily_other == "greatgrandma" |
           cbdata$deaffamily_other == "mathersgroundmather" |
           cbdata$deaffamily_other == "greatgrandmother" |
           cbdata$deaffamily_other == "gtandmother",
         "grandmother", cbdata$deaffamily_other)

# classify relationship as grandfather
cbdata$deaffamily_other <-
  ifelse(cbdata$deaffamily_other == "grandad" | 
           cbdata$deaffamily_other == "grandfathermothersside" | 
           cbdata$deaffamily_other == "grandpa" | 
           cbdata$deaffamily_other == "granfhater" | 
           cbdata$deaffamily_other == "maternalgrandfather" | 
           cbdata$deaffamily_other == "maternalgranfather" | 
           cbdata$deaffamily_other == "paternalgrandfather" |
           cbdata$deaffamily_other == "greatgrandfather",
         "grandfather", cbdata$deaffamily_other)

# classify relationship as cousin
cbdata$deaffamily_other[grepl("cousindeaf|momscousin|motherscousin|nephew",
                            cbdata$deaffamily_other)] <- "cousin"

#create new deaffamily column for grandmother relationship
cbdata$deaffamily_gma <- ifelse(cbdata$deaffamily_other == "grandmother" |
                                cbdata$deaffamily_other == "maternalgrandparents" |
                                cbdata$deaffamily_other == "grandparents", 1, 0)

#create new deaffamily column for grandfather relationship
cbdata$deaffamily_gpa <- ifelse(cbdata$deaffamily_other == "grandfather" |
                                cbdata$deaffamily_other == "maternalgrandparents" |
                                cbdata$deaffamily_other == "grandparents", 1, 0)

#create new deaffamily column for cousin relationship
cbdata$deaffamily_cousin <- ifelse(cbdata$deaffamily_other == "cousin", 1, 0)

#create new deaffamily column for aunt relationship
cbdata$deaffamily_aunt <- ifelse(cbdata$deaffamily_other == "aunt", 1, 0)

#create new deaffamily column for uncle relationship
cbdata$deaffamily_uncle <- ifelse(cbdata$deaffamily_other == "uncle", 1, 0)

# remove deaffamily other columns from dataframe
cbdata <- subset(cbdata, select = -c(deaffamily___8, deaffamily_other))
```

# Cleaning `asdfamily_other`

```{r}
cbdata$asdfamily_other <- tolower(cbdata$asdfamily_other)

cbdata$asdfamily_other <- str_replace_all(cbdata$asdfamily_other, "[^[:alnum:]]", "")

# classify relationship as cousin
cbdata$asdfamily_other[grepl("2ndcousin|                           babysmaternalfirstcousin|coisinhas2degree|cousinonmaternalside|cousins|cousinsonbothsidesofthefamily|fathers2ndcousins|fatherscousin|firstcousin|malecousin|motherscousin|motherscousinhas3autisticchildren|motherscousins|mothershalfcousin|mothersnephew|mymaternalnephew|nephew|niece|nieceaspergers|nieces|paternalfirstcousin|paternalnephew|relativefatherscousin|secondcousin|secondcousins|twofirstcousins|childofmotherscousinonceremoved|fathersnephewfirstcousin|fatherssistersson|mothershalfsisterhastwinswhoareautistic|halfsisterstoddler",
                            cbdata$asdfamily_other)] <- "cousin"

# classify relationship as aunt
cbdata$asdfamily_other[grepl("aunty|fatherssister|halfaunt|maternalaunt|motherssister",
                           cbdata$asdfamily_other)] <- "aunt"

# classify relationship as uncle
cbdata$asdfamily_other[grepl("babysuncle|brotherofthefather|halfbrotherofthefather|halfuncle|motherslittlebrother|unclebrotheroffather|uncles|fathersuncle|momsuncle",
                           cbdata$asdfamily_other)] <- "uncle"

# classify relationship as grandmother
cbdata$asdfamily_other[grepl("mathersgroundmather|mothersmother",
                           cbdata$asdfamily_other)] <- "grandmother"

#create new asdfamily column for grandmother relationship
cbdata$asdfamily_gma <- ifelse(cbdata$asdfamily_other == "grandmother", 1, 0)

#create new asdfamily column for grandfather relationship
cbdata$asdfamily_gpa <- ifelse(cbdata$asdfamily_other == "grandfather", 1, 0)

#create new asdfamily column for cousin relationship
cbdata$asdfamily_cousin <- ifelse(cbdata$asdfamily_other == "cousin" |
                                  cbdata$asdfamily_other == "uncleandcousins", 1, 0)

#create new asdfamily column for aunt relationship
cbdata$asdfamily_aunt <- ifelse(cbdata$asdfamily_other == "aunt", 1, 0)

#create new asdfamily column for uncle relationship
cbdata$asdfamily_uncle <- ifelse(cbdata$asdfamily_other == "uncle" |
                                 cbdata$asdfamily_other == "uncleandcousins", 1, 0)

# remove asdfamily other columns from dataframe
cbdata <- subset(cbdata, select = -c(asdfamily___8, asdfamily_other))
```

# Rose
ddfamily_other

otherszbpfamilymember

otherart

# Lisa
maternalpregnancyproblems_other

trauma_optional

# Allison
mat_mental_health_other

# Cleaning `mat_mental_health_other`

```{r}
# Getting rid of column
cbdata$mat_mental_health_other = NULL

# Cleaning that can be put into other columns
cbdata[c(216, 520, 598, 1089),115] = 1
cbdata[240,83] = 1
cbdata[499,85] = 1
cbdata[c(1683, 2245), 111] = 1


# Adding columns
autoimm = c(34, 687, 915, 1187, 1435, 1825)
cbdata$autoimm = ifelse(rownames(cbdata)%in%autoimm, 1, 0)

uterine = c(1636, 2246)
cbdata$uterine = ifelse(rownames(cbdata)%in%uterine, 1, 0)

extreme = c(202, 817, 2579)
cbdata$extreme = ifelse(rownames(cbdata)%in%extreme, 1, 0)

borderline = c(21, 114, 411, 1049, 1537, 1762, 1863, 2407)
cbdata$borderline = ifelse(rownames(cbdata)%in%borderline, 1, 0)

ptsd = c(91, 191, 683, 738, 770, 1159, 1315, 1473, 1678, 1715, 1727, 1945)
cbdata$ptsd = ifelse(rownames(cbdata)%in%ptsd, 1, 0)

did = c(912, 915)
cbdata$did = ifelse(rownames(cbdata)%in%did, 1, 0)

# Multiple 
cbdata[912, c(227, 232)] = 1
cbdata[915, c(228, 231, 232)] = 1
cbdata[1667, c(112, 231)] = 1
cbdata[2579, c(112, 113, 230, 231)] = 1
cbdata[c(76, 2501), c(111, 112)] = 1
```

otherdrug

# Cleaning `otherdrug`

```{r}
# Getting rid of column
cbdata$otherdrug = NULL

# Adding columns
painrelief = c(34, 533, 1182, 1687, 1804, 2236)
cbdata$painrelief = ifelse(rownames(cbdata)%in%painrelief, 1, 0)

mentdisord = c(904, 1521, 1917)
cbdata$mentdisord = ifelse(rownames(cbdata)%in%mentdisord, 1, 0)

# Moving to existing columns
cbdata[1131, 147] = 1
cbdata[1352, c(141, 145, 147)] = 1
cbdata[2528, 148] = 1
cbdata[c(210, 2537), 146] = 1
cbdata[2577, 141] = 1
cbdata[2298, 144] = 1
```


# Claire
# Cleaning `medicalhistorybaby_other`

```{r}
cbdata$medicalhistorybaby_other <- tolower(cbdata$medicalhistorybaby_other)

library(plyr)
# consolidate blood glucose
cbdata$medicalhistorybaby_other <- revalue(cbdata$medicalhistorybaby_other, c("low sugar/glucose"="low blood glucose","low blood sugar"="low blood glucose", "low glucose at birth"="low blood glucose", "low blood sugar and respiratory problems due to exposure to magnesium sulfate during labor."="low blood glucose", "hypoglicemia at the begining"="low blood glucose","hypoglycemia"="low blood glucose", "glucose observation"="low blood glucose"))
# consolidate neonatal abstinence syndrome
cbdata$medicalhistorybaby_other <- revalue(cbdata$medicalhistorybaby_other, c("nas (neonatal abstinence syndrome)"="neonatal abstinence syndrome","nas"="neonatal abstinence syndrome"))
#consolidate tongue tie
cbdata$medicalhistorybaby_other <- revalue(cbdata$medicalhistorybaby_other, c("tongue and lip tie"="tongue tie","tongue buccal and lip ties"="tongue tie","tongue, lip, and buccal frenectomy"="tongue tie","recurrent lingual frenulum"="tongue tie", "he was tounge tied. had procedure clipping his tounge at hospital 48hrs after birth"="tongue tie"))
# consolidate allergies
cbdata$medicalhistorybaby_other <- revalue(cbdata$medicalhistorybaby_other, c("alergia proteina de la leche de vaca"="milk allergy/intolerance","allergies: don't know specific but mother doesn't eat soy, dairy and nuts"="milk allergy/intolerance","milk allergy"="milk allergy/intolerance", "dairy intolerance" = "milk allergy/intolerance", "intolerance to formula milk"="milk allergy/intolerance", "cmpi"="milk allergy/intolerance"))
cbdata$medicalhistorybaby_other <- revalue(cbdata$medicalhistorybaby_other, c("infection following birth"="infection", "infection, requiring antibiotics"="infection","kidney infection"="infection", "urinary tract infection"="infection"))


# classify as "Cardiac disorder" and then replace in medicalhistorybaby_other as NA
cbdata <- cbdata %>% mutate(medicalhistorybaby___10 = replace(medicalhistorybaby___10, medicalhistorybaby_other == "bicuspid aortic valve" | medicalhistorybaby_other == "vascular ring with right aortic arch", 1))
cbdata <- cbdata %>% mutate(medicalhistorybaby_other = replace(medicalhistorybaby_other, medicalhistorybaby_other == "bicuspid aortic valve" | medicalhistorybaby_other =="vascular ring with right aortic arch", NA))

# classify as "Failure to thrive" and then replace in medicalhistorybaby_other as NA
cbdata <- cbdata %>% mutate(medicalhistorybaby___7 = replace(medicalhistorybaby___7, medicalhistorybaby_other == "loss of weight after birth, after 5 weeks back at birth weight (3,5 kg)" | medicalhistorybaby_other == "growth delay"| medicalhistorybaby_other == "didn't gain weight from breast milk in first two weeks", 1))
cbdata <- cbdata %>% mutate(medicalhistorybaby_other = replace(medicalhistorybaby_other, medicalhistorybaby_other == "loss of weight after birth, after 5 weeks back at birth weight (3,5 kg)" | medicalhistorybaby_other =="growth delay" | medicalhistorybaby_other =="didn't gain weight from breast milk in first two weeks", NA))

# classify as "Small for gestational age" and then replace in medicalhistorybaby_other as NA
cbdata <- cbdata %>% mutate(medicalhistorybaby___15 = replace(medicalhistorybaby___15, medicalhistorybaby_other == "2weeks behind gestational", 1))
cbdata <- cbdata %>% mutate(medicalhistorybaby_other = replace(medicalhistorybaby_other, medicalhistorybaby_other == "2weeks behind gestational", NA))

# remove "other" binary column and character column for medical history
cbdata <- subset(cbdata, select=-c(medicalhistorybaby___19,medicalhistorybaby_other))
```

# Cleaning `whichmedsforbaby`
```{r}
cbdata$whichmedsforbaby <- tolower(cbdata$whichmedsforbaby)

# consolidate antibiotics
cbdata$whichmedsforbaby <- revalue(cbdata$whichmedsforbaby, c("amoxicillin ear infection"="antibiotics","amoxicillin for an ear infection"="antibiotics", "amoxicillin for ear infection"="antibiotics", "antibiotic, cough(cold)"="antibiotics", "antibiotics due to infection"="antibiotics", "penicillin"="antibiotics","cephalexin  - born with bladder on the outside."="antibiotics","polymyxin b sulfate and trimethoprim (pink eye)"="antibiotics","erythromycin eye ointment for infected blocked nasolacrimal duct"="antibiotics"))

# find medications with "reflux","gerd","acid" and classify as acid reflux medication
cbdata$whichmedsforbaby[grepl("reflux|gerd|acid|zantac|ranitidine", cbdata$whichmedsforbaby)] <- "acid reflux medication"
# consolidate acid reflux
cbdata$whichmedsforbaby <- revalue(cbdata$whichmedsforbaby, c("gaviscon"="acid reflux medication", "omeprazole"="acid reflux medication", "omeprazole, probiotica"="acid reflux medication", "omprezol  zamtac" ="acid reflux medication", "reflex" ="acid reflux medication","raditine for heartburn" ="acid reflux medication", "ranitindine"="acid reflux medication","losec mups"="acid reflux medication"))

# find medications to classify as "vitamins"
cbdata$whichmedsforbaby[grepl("vitamin d|vitamin a/d3|vitamin adc|adtil- vitamin|vitamins|liquid multivitamin", cbdata$whichmedsforbaby)] <- "vitamins"

# consolidate antihistamine
cbdata$whichmedsforbaby <- revalue(cbdata$whichmedsforbaby, c("loratadine for stomach."="antihistamine", "allergy medication"="antihistamine", "claritin for allergies"="antihistamine", "zyrtec for seasonal allergies"="antihistamine","carminative mixture with digestive enzymes and cholecalciferon/vitamind3 both are daily. (bd/od)  phenylephrine hcl&chlopheniraminr marate ( sos for 5days if cough and cold)  colocar ez if stomach ack(sos)  hydroxyzine hydrochloride syrup ups (5drops /bd) boils appears on skin diagnosed by dermatologist as scabies."))

# find medications to classify as "colic medication"
cbdata$whichmedsforbaby[grepl("colic|colimil|infacalm", cbdata$whichmedsforbaby)] <- "colic medication"

# find medications to classify as "lactulose"
cbdata$whichmedsforbaby[grepl("lactulose|miralax", cbdata$whichmedsforbaby)] <- "lactulose"

# find medications to classify as "oral thrush medication"
cbdata$whichmedsforbaby[grepl("nystatin|nystan|nilstat|thrush", cbdata$whichmedsforbaby)] <- "oral thrush medication"

# find medications to classify as "hydrocortisone ointment"
cbdata$whichmedsforbaby[grepl("eczema", cbdata$whichmedsforbaby)] <- "hydrocortisone ointment"

# find medications to classify as "iron"
cbdata$whichmedsforbaby[grepl("iron|ferroso", cbdata$whichmedsforbaby)] <- "iron"

# find medications to classify as "hypothyroid medication"
cbdata$whichmedsforbaby[grepl("thyroid|levothyroxine|synthroid", cbdata$whichmedsforbaby)] <- "hypothyroid medication"

# replace "i don't know" and "baby songs are medications for our babies" with NA
cbdata <- cbdata %>% mutate(whichmedsforbaby = replace(whichmedsforbaby, whichmedsforbaby == "i don't know" | whichmedsforbaby == "baby songs are medications for our babies" | whichmedsforbaby == "yas"| whichmedsforbaby =="well she take some fever because she has stuffy nose", NA))

# create binary column for taking acid reflux medication, 147 observations
cbdata$whichmedsforbaby_arm <- ifelse(cbdata$whichmedsforbaby!="acid reflux medication"|is.na(cbdata$whichmedsforbaby), 0, 1)

# remove whichmedsforbaby column from dataframe
cbdata <- subset(cbdata, select=-cbdata$whichmedsforbaby)
```


# Cleaning `babyfedother`
```{r}
cbdata$babyfedother <- tolower(cbdata$babyfedother)
cbdata$babyfedother <- gsub('[[:punct:] ]+','',cbdata$babyfedother)

# consolidate both
cbdata$babyfedother <- revalue(cbdata$babyfedother, c("5050"="both", "bothbreastmilkandformula"="both", "bothformulaandbreastmilk"="both", "bothnowformula"="both", "breastandformula"="both", "breastmilkandformula"= "both", "breastmilkatnightandformuladaytimecuzmomgoworkfulltime"= "both", "breastmilkfortifiedwithformula" = "both", "combination"= "both", "combinationofbreastmilkandformula"="both", "equalbreastandformula"="both","equalpartsbreastmilkandformula"="both", "takingbreastmilkandformula"="both", "breastmilkformulanormalfood"="both","formulaandbreastmilk"="both","mostlybreastmilkuntil4monthsnowmostlyformula"="both", "breastmilktill3monthsthen5050formulaandmilkfor15monthsnowonlyformula"="both","mixofformulaandbreastmilk"="both","mixture"="both","breastmilkx5monthsformulaaftersolidsstartedat8moandmilkstartedat12mo"="both","4monthbreastmilk3monthformulanowcoworbuffalomilk"="both"))

# find medications to classify as "both"
cbdata$babyfedother[grepl("half", cbdata$babyfedother)] <- "both"

# classify from babyfedother to babyfood 1 (All formula) and then replace in babyfedother as NA
cbdata <- cbdata %>% mutate(babyfood = replace(babyfood, babyfedother == "formulatillage1nowwholemilk"| babyfedother == "prescribedformulabydr", 1))
cbdata <- cbdata %>% mutate(babyfedother = replace(babyfedother, babyfedother == "formulatillage1nowwholemilk"|babyfedother =="prescribedformulabydr", NA))

# classify from babyfedother to babyfood 2 (Mostly formula) and then replace in babyfedother as NA
cbdata <- cbdata %>% mutate(babyfood = replace(babyfood, babyfedother == "bothbreastmilkandformulabutmostlyformula"| babyfedother == "70formula30breastmilk"| babyfedother == "breastfeedingfortwomonthsformulafortherest"| babyfedother == "mostly formula some breast milk" | babyfedother == "breastfeduntilmonth4formulafromthenon"|babyfedother == "firstmonth5050lasttwoweeksallformula"|babyfedother == "formulaandsolids", 2))
cbdata <- cbdata %>% mutate(babyfedother = replace(babyfedother, babyfedother == "bothbreastmilkandformulabutmostlyformula"| babyfedother == "70formula30breastmilk"| babyfedother == "breastfeedingfortwomonthsformulafortherest"| babyfedother == "mostly formula some breast milk" | babyfedother == "breastfeduntilmonth4formulafromthenon"|babyfedother == "firstmonth5050lasttwoweeksallformula"|babyfedother == "formulaandsolids", NA))

# classify from babyfedother to babyfood 3 (Mostly breastmilk) and then replace in babyfedother as NA
cbdata <- cbdata %>% mutate(babyfood = replace(babyfood, babyfedother == "breastfeedinguntil8moformulaandsolidfood"|babyfedother =="mostlybreastmilkuntil85monthsthenallformulasolidsintroducedaround5monthsprimarilysolidssince12months"|babyfedother =="breastmilkfor8monthsandthenformula"|babyfedother =="breastmilkuntil4monthsandbreastmilkandsolidsafter"| babyfedother =="breastmilk2xdayotherwisefood"|babyfedother =="breastmilkandfood"| babyfedother =="breastfedandnowaddedfingerfood"|babyfedother =="breastmilkonlysincebirthandbabypuréesstartingat6months"|babyfedother=="breastmilktill5moandthenbreastmilkandsolids"|babyfedother=="breastmilkonlysincebirthandbabypuréesstartingat6months"|babyfedother=="breastmilkandsolidfoods"|babyfedother=="cowmilkandbreastfeedalternatively", 3))
cbdata <- cbdata %>% mutate(babyfedother = replace(babyfedother, babyfedother == "breastfeedinguntil8moformulaandsolidfood"|babyfedother =="mostlybreastmilkuntil85monthsthenallformulasolidsintroducedaround5monthsprimarilysolidssince12months"|babyfedother =="breastmilkfor8monthsandthenformula"| babyfedother =="breastmilkuntil4monthsandbreastmilkandsolidsafter"| babyfedother =="breastmilk2xdayotherwisefood"|babyfedother =="breastmilkandfood"| babyfedother =="breastfedandnowaddedfingerfood"|babyfedother =="breastmilkonlysincebirthandbabypuréesstartingat6months"|babyfedother=="breastmilktill5moandthenbreastmilkandsolids"|babyfedother=="breastmilkonlysincebirthandbabypuréesstartingat6months"|babyfedother=="breastmilkandsolidfoods"|babyfedother=="cowmilkandbreastfeedalternatively", NA))

# classify from babyfedother to babyfood 4 (All breastmilk) and then replace in babyfedother as NA
cbdata <- cbdata %>% mutate(babyfood = replace(babyfood, babyfedother == "breastfedfor12monthsnowonsolidfood"|babyfedother == "breastfedfor12monthsnowonsolidfood"| babyfedother =="breastfedandnowaddedfingerfood"| babyfedother =="exclusivelypumpedbreastmilk", 4))
cbdata <- cbdata %>% mutate(babyfedother = replace(babyfedother, babyfedother == "breastfedfor12monthsnowonsolidfood"|babyfedother == "breastfedfor12monthsnowonsolidfood"| babyfedother =="exclusivelypumpedbreastmilk", NA))

# classify "both" and "other" as 3 (middle)
cbdata$babyfood[cbdata$babyfood == 5] <- 0
cbdata$babyfood[cbdata$babyfood == 4] <- 5
cbdata$babyfood[cbdata$babyfood == 3] <- 4
cbdata$babyfood[cbdata$babyfood == 0] <- 3

# remove `babyfedother` column
cbdata <- subset(cbdata, select=-babyfedother)
```

# Kayla

```{r}
# unusualtext column cleaning

# Get rid of original unusualtext column
cbdata$unusualtext <- NULL
# New column 1: unusual bodily movements 
unusualmovements <- c(30, 202, 252, 291, 325, 349, 371, 485, 517, 559, 759, 960, 1143, 1280, 1288, 1352, 
                      1384, 1432, 1435, 1461, 1810, 2296, 2304, 2310, 2313, 2415, 2498, 2511)
cbdata$unusualmovements <- ifelse(rownames(cbdata)%in%unusualmovements, 1, 0)

#New column 2: unusual actions/reactions (not aggressive)
unusual_actions_nonagressive <- c(54, 234, 299, 383, 420, 452, 456, 479, 522, 535, 692, 863, 902, 913, 
                                  914,915, 955, 1001, 1023, 1048, 1090, 1109, 1163, 1200, 1254, 1303, 1325,
                                  1398, 1429, 1533,1577, 1623, 1695, 1786, 1794, 1826, 1883, 1931, 1993, 
                                  2007, 2133, 2199, 2315, 2360, 2450, 2466, 2562)
cbdata$unusual_actions_nonagressive <- ifelse(rownames(cbdata)%in%unusual_actions_nonagressive, 1, 0)

#New column 3: unusual actions/reactions (aggressive)
unusual_actions_aggressive <- c(629, 706, 740, 875, 997, 1138, 1156, 1296, 1297, 1471, 1595, 1683, 1777, 1799, 
                               1838, 1909, 1945, 1981, 2019, 2033, 2079, 2275, 2339, 2447, 2476, 2485)
cbdata$unusual_actions_aggressive <- ifelse(rownames(cbdata)%in%unusual_actions_aggressive, 1, 0)



# otherbehaviors column cleaning

# Get rid of original otherbehaviors column
cbdata$otherbehaviors <- NULL
#New column 1: Behind on developmental milestones
otherbehaviors_delayed_milestones <-   c(30, 54, 128, 339, 371, 383, 461, 543, 605, 629, 683, 754, 958, 959, 965, 1068,
                                         1153, 1190, 1271, 1284, 1325, 1419, 1432, 1578, 1634, 1705, 1708, 1762, 1931, 
                                         1943, 1947, 1955, 2100, 2171, 2232, 2236, 2305, 2312, 2339, 2358, 2431, 2476, 2555)
cbdata$otherbehaviors_delayed_milestones <- ifelse(rownames(cbdata)%in%otherbehaviors_delayed_milestones, 1, 0)

#New column 2: Behavioral abnormalities
otherbehaviors_behavioral_abnormalities <-  c(13, 248, 362, 493, 669, 740, 752, 759, 761, 773, 856, 875, 902, 940, 1027, 
                                              1101, 1134, 1339, 1385, 1400, 1472, 1474, 1479, 1505, 1584, 1613, 1694, 1729, 
                                              1774, 1777, 1859, 1981, 2002, 2049, 2054, 2069, 2081, 2275, 2295, 2309, 2316,
                                              2399, 2400, 2447, 2466, 2519, 2573)
cbdata$otherbehaviors_behavioral_abnormalities <- ifelse(rownames(cbdata)%in%otherbehaviors_behavioral_abnormalities, 1, 0)

#New column 3: Bodily function abnormalities
otherbehaviors_body_function_abnormalities <-  c(19, 22, 167, 192, 200, 427, 455, 598, 634, 733, 981, 1126, 1473, 1575, 1610, 
                                                 1623, 1624, 1641, 1645, 1746, 1755, 1794, 1867, 1875, 2199, 2218, 2313, 2315,
                                                 2359, 2449, 2459, 2517, 2524)
cbdata$otherbehaviors_body_function_abnormalities <- ifelse(rownames(cbdata)%in%otherbehaviors_body_function_abnormalities, 1, 0)

#New column 4: Family history or other diagnoses concerns
otherbehaviors_familyhistory_otherdiagnoses <- c(21, 448, 695, 712, 941, 1074, 1083, 1468, 1683, 1902, 1936, 1958, 2007,
                                                 205, 2079, 2435, 2567)
cbdata$otherbehaviors_familyhistory_otherdiagnoses <- ifelse(rownames(cbdata)%in%otherbehaviors_familyhistory_otherdiagnoses, 1, 0)

```


