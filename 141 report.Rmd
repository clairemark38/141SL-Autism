---
title: 'Stats 141SL '
author: "Rose Din (ID: 804764627), Lisa Kaunitz (ID: 404731988), Claire Markey (ID: 104789928), Allison Ocelo (ID: 404799327), Cristina Sanchez (ID: 805119924), and Kayla Schroeder (ID: 804729436) - Section 1A"
header-includes:
- \usepackage[usenames ,dvipsnames ,svgnames ,table]{xcolor}
- \usepackage{fontspec}
- \newfontfamily\comic[Scale=2]{ComicSansMS}
- \usepackage{graphicx}
- \usepackage{tabularx}
- \usepackage{enumitem}
- \usepackage{amsmath,amssymb,amsthm}
date: "03/05/2020"
output: 
  pdf_document:
    latex_engine: xelatex
    toc: true
    toc_depth: 3
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
\thispagestyle{empty}
\newpage
\section{Abstract}
\.par

In this study, we worked to determine factors that predispose children to autistic behaviors. To do this, we explored a dataset obtained from the ChatterBaby application’s survey which included input from users across the globe. We began by cleaning the dataset to remove missing values and performed some initial data analysis along with random forest modeling to determine which factors were most important of all prenatal factors. A Poisson model was then used to explain the data. In our literature review, we uncovered that autism diagnoses in males is systematically different from these same diagnoses in females and we want to determine if this difference in sex is statistically significant when looking at predictors for autism in the different sexes. As such, we chose to develop additional Poisson models that were separated by sex in an effort to control for this discrepancy. Through this modeling we found that there are a multitude of different risk factors that are statistically significant, however, these risk factors vary by sex. Consequently, we conclude that there is a significant difference between males and females regarding risk factors that predispose a child to ASD behaviors and that the number of mental health diagnoses for the mother is chief amongst the risk factors as this is the only factor that appears in all three models. 

```{r echo=FALSE, warning=FALSE, message=FALSE, include=FALSE}
#load packages
library(readr)
library(dplyr)
library(stringr)

#load data
cbdata <- read_csv("ChatterBabyData.csv")

# Dealing with NAs
# Cleaning NA's to 0's: 

which(colnames(cbdata) == "mat_dep"):which(colnames(cbdata) == "momfever")
cbdata[,c(126:133)][is.na(cbdata[,c(126:133)])] <- 0
cbdata$art[is.na(cbdata$art)] <- 0 
cbdata$asd_genetic[is.na(cbdata$asd_genetic)] <- 0 
#fix some NA's in totalpregnancies by setting to number of live births
cbdata$totalpregnancies[which(is.na(cbdata$totalpregnancies) == TRUE & is.na(cbdata$momlivebirths) == FALSE)] <- 
cbdata$momlivebirths[which(is.na(cbdata$totalpregnancies) == TRUE & is.na(cbdata$momlivebirths) == FALSE)]
#fix some NA's in totalpregnancies by setting to 1 if no siblings and not adopted
cbdata$totalpregnancies[which(is.na(cbdata$totalpregnancies) == TRUE & cbdata$birthordertotal == 0 & cbdata$adoption == 0)] <- 1
# set live births to number of total pregnancies 
# if number of total pregnancies = number of total siblings + 1(baby)
# so as to not include miscarriages
cbdata$momlivebirths[which((is.na(cbdata$momlivebirths) == TRUE) &
                           (cbdata$totalpregnancies == (cbdata$birthordertotal + 1)))] <-
  cbdata$totalpregnancies[which((is.na(cbdata$momlivebirths) == TRUE) & 
                                (cbdata$totalpregnancies == (cbdata$birthordertotal + 1)))]
# set live births to number of total pregnancies 
# if number of total pregnancies = number of full siblings + 1(baby) 
# so as to not include miscarriages (where birthordertotal = 0 because of NA in olderhalfsiblings)
cbdata$momlivebirths[which((is.na(cbdata$momlivebirths) == TRUE) &
                           (cbdata$totalpregnancies == (cbdata$numberfullsiblings + 1)))] <-
  cbdata$totalpregnancies[which((is.na(cbdata$momlivebirths) == TRUE) & 
                                (cbdata$totalpregnancies == (cbdata$numberfullsiblings + 1)))]
# set live births to number of full siblings + 1
# if number of total pregnancies > number of full siblings and 
# number of older half siblings = 0 so as to not include children only from father and miscarriages
cbdata$momlivebirths[which((is.na(cbdata$momlivebirths) == TRUE) & 
                           (cbdata$totalpregnancies > cbdata$numberfullsiblings) &
                           cbdata$olderhalfsiblings == 0 )] <-
  cbdata$numberfullsiblings[which((is.na(cbdata$momlivebirths) == TRUE) & 
                                  (cbdata$totalpregnancies > cbdata$numberfullsiblings) &
                                  cbdata$olderhalfsiblings == 0 )] + 1

# Cleaning `maternalpregnancyproblems_other`

# classify as post partum psychosis
cbdata <- cbdata %>% mutate(maternalpregnancyproblems___20 = replace(maternalpregnancyproblems___20, maternalpregnancyproblems_other == "post partum anxiety" | maternalpregnancyproblems_other == "Post partum anxiety" | maternalpregnancyproblems_other == "Post-partum anxiety" | maternalpregnancyproblems_other == "Postpartum hemorrhaging" | maternalpregnancyproblems_other == "Perinatal anxiety",1))
cbdata <- cbdata %>% mutate(maternalpregnancyproblems_other = replace(maternalpregnancyproblems_other, maternalpregnancyproblems_other == "post partum anxiety" | maternalpregnancyproblems_other == "Post partum anxiety" | maternalpregnancyproblems_other == "Post-partum anxiety" | maternalpregnancyproblems_other == "Postpartum hemorrhaging" | maternalpregnancyproblems_other == "Perinatal anxiety", NA ))
# classify as Chorioamnionitis 
cbdata <- cbdata %>% mutate(maternalpregnancyproblems___21 = replace(maternalpregnancyproblems___21, maternalpregnancyproblems_other == "Chorioamnionitis", 1))
cbdata <- cbdata %>% mutate(maternalpregnancyproblems_other = replace(maternalpregnancyproblems_other, maternalpregnancyproblems_other == "Chorioamnionitis", NA))
# classify as bleeding
cbdata <- cbdata %>% mutate(maternalpregnancyproblems___14 = replace(maternalpregnancyproblems___14, maternalpregnancyproblems_other == "Unusual pain in the abdomen, stress, miscarriage probability, bleeding.", 1))
cbdata <- cbdata %>% mutate(maternalpregnancyproblems_other = replace(maternalpregnancyproblems_other, maternalpregnancyproblems_other == "Unusual pain in the abdomen, stress, miscarriage probability, bleeding.", NA))
# classify as preterm labor
cbdata <- cbdata %>% mutate(maternalpregnancyproblems___11 = replace(maternalpregnancyproblems___11, maternalpregnancyproblems_other == "Early contractions with diction starting at 30 weeks. I received steroid shot to develop baby's lungs faster.", 1))
cbdata <- cbdata %>% mutate(maternalpregnancyproblems_other = replace(maternalpregnancyproblems_other, maternalpregnancyproblems_other == "Early contractions with diction starting at 30 weeks. I received steroid shot to develop baby's lungs faster.", NA))
# classify as History of recurrent miscarriage/ recurrent pregnancy loss 
cbdata <- cbdata %>% mutate(maternalpregnancyproblems___10 = replace(maternalpregnancyproblems___10, maternalpregnancyproblems_other == "Prior full term stillbirth; had double nuchal cord resulting in emergent csection at 36 weeks", 1))
cbdata <- cbdata %>% mutate(maternalpregnancyproblems_other = replace(maternalpregnancyproblems_other, maternalpregnancyproblems_other == "Prior full term stillbirth; had double nuchal cord resulting in emergent csection at 36 weeks", NA))
# classify as hypertension
cbdata <- cbdata %>% mutate(maternalpregnancyproblems___9 = replace(maternalpregnancyproblems___9, maternalpregnancyproblems_other == "Protein in urine day of induction and hypertension only at 38 weeks" | maternalpregnancyproblems_other == "Mild hypertension at 37 weeks", 1))
cbdata <- cbdata %>% mutate(maternalpregnancyproblems_other = replace(maternalpregnancyproblems_other, maternalpregnancyproblems_other == "Protein in urine day of induction and hypertension only at 38 weeks"| maternalpregnancyproblems_other == "Mild hypertension at 37 weeks", 1))
# classify as 13, Placental abruption
cbdata <- cbdata %>% mutate(maternalpregnancyproblems___13 = replace(maternalpregnancyproblems___13, maternalpregnancyproblems_other == "Calcified placenta" | maternalpregnancyproblems_other == "Placenta calcification" | maternalpregnancyproblems_other == "Placenta hematoma" | maternalpregnancyproblems_other == "placental aging" | maternalpregnancyproblems_other == "Underperfusion placenta" , 1))
cbdata <- cbdata %>% mutate(maternalpregnancyproblems_other = replace(maternalpregnancyproblems_other, maternalpregnancyproblems_other == "Calcified placenta" | maternalpregnancyproblems_other == "Placenta calcification" | maternalpregnancyproblems_other == "Placenta hematoma" | maternalpregnancyproblems_other == "placental aging"| maternalpregnancyproblems_other == "Underperfusion placenta", NA))
# Get rid of the column 
cbdata$maternalpregnancyproblems_other <- NULL


# Cleaning `mom_trauma`
# Convert all Mom Trauma NA's to 0: 
cbdata$mom_trauma[is.na(cbdata$mom_trauma)] <- 0

# Cleaning `mat_mental_health_other`
# Getting rid of column
cbdata$mat_mental_health_other = NULL
# Cleaning that can be put into other columns
cbdata[c(216, 520, 598, 1089),115] = 1
cbdata[240,83] = 1
cbdata[499,85] = 1
cbdata[c(1683, 2245), 111] = 1
# Multiple entries for one person
cbdata[912, c(227, 232)] = 1
cbdata[915, c(228, 231, 232)] = 1
cbdata[1667, c(112, 231)] = 1
cbdata[2579, c(112, 113, 230, 231)] = 1
cbdata[c(76, 2501), c(111, 112)] = 1

# Creating maternal mental health count variable
cbdata <- cbdata %>% mutate(mathealth_count = matmentalhealth___1 + matmentalhealth___2 + matmentalhealth___3 + matmentalhealth___4 + matmentalhealth___5 + matmentalhealth___6 + matmentalhealth___7)

# Cutting off Baby Age at 5 years old
cbdata$babyage = ifelse(cbdata$babyage <= 1825, cbdata$babyage, NA)

predata <- cbdata %>% select(babyage, momsdeliveryage, momsedu, sex, art, artmethod___1,
                          artmethod___7, artmethod___6, artmethod___2, artmethod___3,
                          artmethod___4, artmethod___5, mom_trauma,
                          maternalpregnancyproblems___1, maternalpregnancyproblems___2,
                          maternalpregnancyproblems___3, maternalpregnancyproblems___15,
                          maternalpregnancyproblems___21, maternalpregnancyproblems___16,
                          maternalpregnancyproblems___4, maternalpregnancyproblems___5,
                          maternalpregnancyproblems___6, maternalpregnancyproblems___7,
                          maternalpregnancyproblems___8, maternalpregnancyproblems___9,
                          maternalpregnancyproblems___10, maternalpregnancyproblems___11,
                          maternalpregnancyproblems___12, maternalpregnancyproblems___13,
                          maternalpregnancyproblems___14, maternalpregnancyproblems___17,
                          maternalpregnancyproblems___19, maternalpregnancyproblems___20,
                          maternalpregnancyproblems___18,
                          matmentalhealth___1, matmentalhealth___2, matmentalhealth___3,
                          matmentalhealth___4, matmentalhealth___5, matmentalhealth___6,
                          matmentalhealth___7, mat_dep, mat_anx,
                          mat_ocd, mat_bp, mat_adhd, mat_pssd, mathealth_count, momfever, whenfever___1,
                          whenfever___2, whenfever___3, tobacco_pregnancy_when___1,
                          tobacco_pregnancy_when___2, tobacco_pregnancy_when___3,
                          vaping_pregnancy___1, vaping_pregnancy___2, vaping_pregnancy___3,
                          alcohol_pregnancy_when___1, alcohol_pregnancy_when___2,
                          alcohol_pregnancy_when___3, cannabis_pregnancy_when___1,
                          cannabis_pregnancy_when___2, cannabis_pregnancy_when___3,
                          stimulants_pregnancy_when___1, stimulants_pregnancy_when___2,
                          stimulants_pregnancy_when___3, opioids_pregnancy_when___1,
                          opioids_pregnancy_when___2, opioids_pregnancy_when___3,
                          psychoactive_pregnancy___1, psychoactive_pregnancy___2,
                          psychoactive_pregnancy___3, delivery, momlivebirths,
                          totalpregnancies, maternalproblems1, asd1, deaf1, ddfamily1,
                          szbpfamily1, risk_score_ASD)

# filter out age and live births outliers
predata <- predata %>% filter(momlivebirths != 10 & momsdeliveryage != 12 | momlivebirths != 10 & momsdeliveryage != 18)
summary(predata)

# Creating count variables for diff. drugs:
# resulting columns are total number of trimesters drug was used
predata$tri_tobacco = rowSums(predata[,52:54])
predata$tri_vaping = rowSums(predata[,55:57])
predata$tri_alcohol = rowSums(predata[,58:60])
predata$tri_cannabis = rowSums(predata[,61:63])
predata$tri_stimulants = rowSums(predata[,64:66])
predata$tri_opioids = rowSums(predata[,67:69])
predata$tri_psychoactives = rowSums(predata[,70:72])
# getting rid of "when drug" columns
predata[,52:72] = NULL

# Convert mat_variable rows that occur after birth

predata$mat_adhd <- ifelse(predata$mat_adhd==3, 0, predata$mat_adhd)
predata$mat_dep <- ifelse(predata$mat_dep==3, 0, predata$mat_dep)
predata$mat_anx <- ifelse(predata$mat_anx==3, 0, predata$mat_anx)
predata$mat_ocd <- ifelse(predata$mat_ocd==3, 0, predata$mat_ocd)
predata$mat_bp <- ifelse(predata$mat_bp==3, 0, predata$mat_bp)
predata$mat_pssd <- ifelse(predata$mat_pssd==3, 0, predata$mat_pssd)

# Convert mat_variable rows to show that mental health problem occurs before or during pregnancy
predata$mat_adhd <- ifelse(predata$mat_adhd==2, 1, predata$mat_adhd)
predata$mat_dep <- ifelse(predata$mat_dep==2, 1, predata$mat_dep)
predata$mat_anx <- ifelse(predata$mat_anx==2, 1, predata$mat_anx)
predata$mat_ocd <- ifelse(predata$mat_ocd==2, 1, predata$mat_ocd)
predata$mat_bp <- ifelse(predata$mat_bp==2, 1, predata$mat_bp)
predata$mat_pssd <- ifelse(predata$mat_pssd==2, 1, predata$mat_pssd)

# Create new column

predata <- predata %>% mutate(babymortality = totalpregnancies-momlivebirths)

# Converting binary variables to factors
predata$delivery <- as.factor(predata$delivery)
predata$sex <- as.factor(predata$sex)
predata$mom_trauma <- as.factor(predata$mom_trauma)
predata$maternalpregnancyproblems___8 <- as.factor(predata$maternalpregnancyproblems___8)
predata$artmethod___1 <- as.factor(predata$artmethod___1)
predata$maternalpregnancyproblems___1 <- as.factor(predata$maternalpregnancyproblems___1)
predata$maternalpregnancyproblems___2 <- as.factor(predata$maternalpregnancyproblems___2)
predata$maternalpregnancyproblems___3 <- as.factor(predata$maternalpregnancyproblems___3)
predata$maternalpregnancyproblems___16 <- as.factor(predata$maternalpregnancyproblems___16)
predata$maternalpregnancyproblems___4 <- as.factor(predata$maternalpregnancyproblems___4)
predata$maternalpregnancyproblems___7 <- as.factor(predata$maternalpregnancyproblems___7)
predata$maternalpregnancyproblems___9 <- as.factor(predata$maternalpregnancyproblems___9)
predata$maternalpregnancyproblems___11 <- as.factor(predata$maternalpregnancyproblems___11)
predata$maternalpregnancyproblems___13 <- as.factor(predata$maternalpregnancyproblems___13)
predata$maternalpregnancyproblems___14 <- as.factor(predata$maternalpregnancyproblems___14)

# Controlling for Sex:
maledata <- predata %>% filter(sex == 1)
femaledata <- predata %>% filter(sex == 0)


```


\newpage
\section{Research Questions}

\setlength{\parindent}{4em}
\setlength{\parskip}{1em}
.\par
In our study, we developed two research questions concentrating on significant predictors that can detect if a child will exhibit behaviors that relate to having Autistic Spectrum Disorder, a developmental disorder that impairs communication and interaction, and if there is a difference in these predictors for males and females. Our first research question focuses on discovering risk factors that could predispose a child’s tendency towards exhibiting behaviors that relate to having ASD. We examine the mother’s prenatal characteristics in order to see if any of these factors increase their child’s ASD behaviors and determine what these factors may be. Our second research question arose after our literature review, which found that the signs for ASD in boys can be diagnosed as early as two years of age while it may take up to 14 years for girls due to the differences in the way that autism presents itself between genders (Geelhand). We also found that there is a stark difference in the proportion of males versus females that have autism with the most recent ratio being 3 males for every female (National Autistic Society). Taking this into account, our second research question focuses on whether there is a significant difference in the predictors of ASD for males versus females and what these specific predictors are.


\section{Variables of the Study and how they were Measured}

\setlength{\parindent}{4em}
\setlength{\parskip}{1em}
.\par
For this study, only prenatal factors were taken into account. Any variable that was not clearly a factor from the time before a child was born was removed and the subsetted dataset “predata” was created. This dataset contains 68 predictors and the outcome variable `risk_score_ASD`. Binary variables coded as numeric were converted to factors where 1 means an attribute is present and 0 means not present. The variable `delivery` was converted to a factor as the numbers indicate a certain type of delivery method. All other variables were kept as numeric. \par Nine variables in “predata” were created from other variables in the original dataset; these are `mathealth_count`, `babymortality` and 7 variables beginning with “tri_.”  The count variable “mathealth_count” created from “matmentalhealth” tells how many different mental health diagnoses the mother had before, during, or after pregnancy. This was done by summing the binary variables under “matmentalhealth.” The series of count variables beginning with “tri_” were created from the “drugsalcoholtobacco” categories and they tell how many trimesters a mother used a certain drug for (1, 2, or 3). The variable “babymortality” conveys pregnancies that resulted in a mother not having a live birth so the variable is a difference of “totalpregnacies” and “momslivebirths.” 

## Final Predata Codebook
\begin{center}
\begin{tabular}{ | l | l | p{10cm} |} 
\hline
\multicolumn{3}{|c|}{Data Codebook} \\
\hline
Number & Attribute & Description \\
\hline
\hline
1 & momsdeliveryage & Mother's Age at Delivery.\\ \hline
2 & momsedu & Mother's Education Level. 1, Less than High School | 2, High School Graduate | 3, Some College, Trade School, or Associates Degree | 4, College Graduate (Bachelors) | 5, Graduate School | 6, Not Sure/Unknown		\\ \hline
3 & delivery & How was your baby delivered? 1, Unassisted Vaginal Birth|2, Assisted Vaginal Birth (forceps, vacuum)|3, Planned Caesarean|4, Emergency Caesarean	\\ \hline
4 & babymortality & Misscarriages, or infant death at birth \\ \hline
5 & mathealth count & Maternal mental health count\\ \hline
6 & sex & Baby's Gender. 1 = Male, 0 = Female	\\ \hline
7 & tri alcohol & Total number of trimesters alcohol was used.	\\ \hline
8 & tri tabacco & Total number of trimesters tabacco was used. \\ \hline	
9 & tri vaping & Total number of trimesters vaping was used.\\ \hline
10 & tri cannabis & Total number of trimesters cannabis was used.\\ \hline		   
11 & mom trauma & Did the mother experience any extremely stressful event during pregnancy, such as the death of a family member, divorce, homelessness, living in a war zone, or abuse?\\ \hline	
12 & asd1 & Total number of family members with ASD (experiencing other)	
1 = have 1+ family members with ASD, 0 otherwise.\\ \hline		   
13 & szbpfamily1 & Total number of family members with SZ/BP (experiencing other). 
1 = have 1+ family members with SZ/BP, 0 otherwise. \\ \hline	
14 & ddfamily1 &Did any of the following family members have a history of developmental delay while an infant?
1 = have 1+ family members with developmental delay, 0 otherwise\\ \hline	
15 & artmethod 1  & In vitro fertilization (IVF) assisted in conceiving baby.	\\ \hline
16 & whenfever 3 & Mothers fever during Third Trimester (weeks 28-40). \\ \hline
29 & deaf1 & Total number of family members Deaf (experiencing other).
1 = have 1+ family members Deaf, 0 otherwise.\\ \hline	
17 & maternalpregnancyproblems 1 & Were there any of the following interventions, complications, or abnormalities during this pregnancy with baby - Gestational diabetes. \\ \hline
18 & maternalpregnancyproblems 2 & Infections requiring antibiotics . \\ \hline
19 & maternalpregnancyproblems 3 & Placenta previa. \\ \hline
20 & maternalpregnancyproblems 4 & Antidepressants to treat depression. \\ \hline
21 & maternalpregnancyproblems 7 & Preeclampsia/eclampsia . \\ \hline
22 & maternalpregnancyproblems 8 & Anemia. \\ \hline
23 & maternalpregnancyproblems 9 &Hypertension (high blood pressure). \\ \hline
24 & maternalpregnancyproblems 11 & Preterm labor. \\ \hline
25 & maternalpregnancyproblems 13 & Placental abruption. \\ \hline
26 & maternalpregnancyproblems 14 & Vaginal bleeding. \\ \hline
27 & maternalpregnancyproblems 16 & Hyperemesis gravidarum. \\ \hline
28 & risk score ASD & Total number of ASD risk behaviors.  Large number suggests higher risk.\\  
\hline 
\end{tabular} 
\end{center}


\newpage
\section{Exploratory Data Analysis}

## The Five Factors from Literature Review

\setlength{\parindent}{4em}
\setlength{\parskip}{1em}
.\par 
To begin our exploratory data analysis, the client provided us with an online article to get familiar with autism spectrum disorder. Literature review from this study revealed that there are certain factors that increase a child’s risk for ASD: the child’s sex, the child’s family history, other disorders present in the child, if the child was born extremely preterm, and the parents’ delivery ages (“Autism spectrum disorder”). Males are more likely than females to develop ASD (“Autism spectrum disorder”). A child’s risk for autism spectrum disorder increases if a relative, such as a sibling, parent, cousin, etc., has already been diagnosed with the disorder (“Autism spectrum disorder”). Pre-existing health conditions such as fragile X syndrome, tuberous sclerosis, and Rett syndrome, can increase a baby’s risk (“Autism spectrum disorder”). Babies born before 26 weeks of gestation are at higher risk compared to those born later (“Autism spectrum disorder”). Finally, children born to older parents at the time of delivery are at higher risk for autism spectrum disorder compared to those born to younger parents (“Autism spectrum disorder”). \par

In order look further into some of these potential risk factors, boxplots were created in order to take a look at the distribution of ASD risk scores in relation to these variables. It should be noted that these plots were created prior any data cleaning. Hence, we saw what needed to be cleaned through some of the following graphs.

```{r, warning=FALSE, message=FALSE, echo=FALSE, fig.width=3, fig.height=3}
library(readr)
library(ggplot2)

adata <- read_csv("ChatterBabyData.csv")

# Sex vs Risk Score; 0 = female, 1 = male
adata$sex <- ifelse(adata$sex == 0, "Female", "Male")
ggplot(data = adata, aes(x = sex, y = risk_score_ASD, group = sex)) + geom_boxplot(fill = c("pink", "light blue", "gray")) + ggtitle("Box Plot of Child's Sex\n and Child's ASD Risk Score") + labs(y = "Child's Risk Score for ASD", x = "Child's Sex", caption = "Figure 4.1.1") + theme(plot.title = element_text(hjust = 0.5, size = 12), plot.caption = element_text(face = "italic", hjust = 1))

# Family History vs Risk Score; asd1 = 1+ family member(s) also has ASD
adata$asd1 <- ifelse(adata$asd1 == 0, "No", "Yes")
ggplot(data = adata, aes(x = asd1, y = risk_score_ASD, group = asd1)) + geom_boxplot(fill = c("firebrick3", "firebrick1")) + ggtitle("Box Plot of Family History\n and Child's ASD Risk Score") + labs(y = "Child's Risk Score for ASD", x = "Does At Least One Family Member\n Have ASD?", caption = "Figure 4.1.2") + theme(plot.title = element_text(hjust = 0.5, size = 12), plot.caption = element_text(face = "italic", hjust = 1))
```
\setlength{\parindent}{4em}
\setlength{\parskip}{1em}
.\par
Figure 4.1.1 consists of the ASD risk score distributions based on males versus females. Figure 4.1.2 separates the visualizations based on family history of ASD diagnosis. For both, the median is around 6 and unfortunately, there is not much difference between the medians and distributions regardless of whatever category the observations fell in.

```{r, warning=FALSE, message=FALSE, echo=FALSE, fig.width=3, fig.height=3}
# Parent's Ages vs Risk Score
adata$oldermom <- ifelse(adata$momsdeliveryage >= 35, "Yes", "No")
adata$olderdad <- ifelse(adata$dadsdeliveryage >= 35, "Yes", "No")
ggplot(data = adata, aes(x = oldermom, y = risk_score_ASD, group = oldermom)) + geom_boxplot(fill = c("plum3", "plum1", "gray")) + ggtitle("Box Plot of Mother's Delivery Age\n and Child's ASD Risk Score") + labs(y = "Child's Risk Score for ASD", x = "Was the Mother Aged 35 or Older\n During Delivery?", caption = "Figure 4.1.3") + theme(plot.title = element_text(hjust = 0.5, size = 12), plot.caption = element_text(face = "italic", hjust = 1))
ggplot(data = adata, aes(x = olderdad, y = risk_score_ASD, group = olderdad)) + geom_boxplot(fill = c("coral3", "coral1", "gray")) + ggtitle("Box Plot of Father's Delivery Age\n and Child's ASD Risk Score") + labs(y = "Child's Risk Score for ASD", x = "Was the Father Aged 35 or Older\n During Delivery?", caption = "Figure 4.1.4") + theme(plot.title = element_text(hjust = 0.5, size = 12), plot.caption = element_text(face = "italic", hjust = 1))
```
\setlength{\parindent}{4em}
\setlength{\parskip}{1em}
.\par
Figure 4.1.3 visualizes the mother’s delivery age and Figure 4.1.4 visualizes the father’s delivery age compared to risk score. These boxplots look similar to the previous ones and there is not much difference regardless if the parents were under or over 35 years of age. However, it can be noted that this is an area that still needs to be heavily researched.

```{r, warning=FALSE, message=FALSE, echo=FALSE, fig.width=3, fig.height=3}
# Other disorders: Was the autism diagnosis related to a genetic mutation such as fragile X or 22q11.2 deletion syndrome?
adata$asd_genetic <- ifelse(adata$asd_genetic == 0, "No", "Yes")
ggplot(data = adata, aes(x = asd_genetic, y = risk_score_ASD, group = asd_genetic)) + geom_boxplot(fill = c("seagreen4", "seagreen1", "gray")) + ggtitle("Box Plot of Other Disorders\n and Child's ASD Risk Score") + labs(y = "Child's Risk Score for ASD", x = "Was the Child's ASD Diagnosis\n Related to a Genetic Mutation?", caption = "Figure 4.1.5") + theme(plot.title = element_text(hjust = 0.5, size = 12), plot.caption = element_text(face = "italic", hjust = 1))

# Preterm Babies and Risk Score (born before 26 weeks)
adata$preterm <- ifelse(adata$babygestation < 26, "Yes", "No")
ggplot(data = adata, aes(x = preterm, y = risk_score_ASD, group = preterm)) + geom_boxplot(fill = c("cyan4", "cyan1", "gray")) + ggtitle("Box Plot of Prematurity\n and Child's ASD Risk Score") + labs(y = "Child's Risk Score for ASD", x = "Was the Baby Born Before\n 26 Weeks of Gestation?", caption = "Figure 4.1.6") + theme(plot.title = element_text(hjust = 0.5, size = 12), plot.caption = element_text(face = "italic", hjust = 1))
```
\setlength{\parindent}{4em}
\setlength{\parskip}{1em}
.\par

Figure 4.1.5 consists of distributions based on a child's diagnosis of a genetic mutation, such as fragile X syndrome, and Figure 4.1.6 compares babies born prior to 26 weeks of gestation versus those born later. Those whose ASD diagnosis was related to a genetic mutation have a different distribution and median in risk score compared to those who did not. It can also be observed that the 25th and 75th percentiles of those born before 26 weeks of gestation differs from those who were not.


## Drug Use During Pregnancy and Risk Score
.\par 
After cleaning the data set, we wanted to look at the relationships between drug use during pregnancy and risk score in order to potentially include these in our models. The seven main drugs listed on the survey were tobacco, vaping, alcohol, cannabis, stimulants (such as cocaine), opioids, and psychoactives (such as hallucinogens). However, one of our main concerns was if there was enough data on each drug. Response bias was potentially present in the survey data and underreporting could have occurred because some of the mothers may not have been truthful about their drug habits. Therefore, jitter plots were made to examine how many data points we had in each category. On the x-axis for all of the jitter plots, we have the number of trimesters a mother used that particular drug. The colors correspond to the risk score and basically follow the colors of a rainbow, beginning with red equaling 1 up to magenta equaling 12.

```{r, warning=FALSE, message=FALSE, echo=FALSE, fig.width=7}
predata1 <- read_csv("predata.csv")

ggplot(predata1, aes(x = tri_tobacco, y = risk_score_ASD, color = risk_score_ASD)) + geom_jitter() + scale_color_gradientn(colours = rainbow(12)) + ggtitle("Jitter Plot of Tobacco Use During Pregnancy and Child's ASD Risk Score") + labs(y = "Child's Risk Score for ASD", x = "Number of Trimesters Tobacco Was Used", caption = "Figure 4.2.1") + theme(plot.title = element_text(hjust = 0.5, size = 12), plot.caption = element_text(face = "italic", hjust = 1))
```
.\par 
Figure 4.2.1 is a distribution of risk scores based on the mothers' smoking habits. An overwhelming majority of mothers did not smoke during pregnancy, but there were quite a number who did.


```{r, warning=FALSE, message=FALSE, echo=FALSE, fig.width=7}
ggplot(predata1, aes(x = tri_vaping, y = risk_score_ASD, color = risk_score_ASD)) + geom_jitter() + scale_color_gradientn(colours = rainbow(12)) + ggtitle("Jitter Plot of Vaping During Pregnancy and Child's ASD Risk Score") + labs(y = "Child's Risk Score for ASD", x = "Number of Trimesters Mother Vaped", caption = "Figure 4.2.2") + theme(plot.title = element_text(hjust = 0.5, size = 12), plot.caption = element_text(face = "italic", hjust = 1))

ggplot(predata1, aes(x = tri_alcohol, y = risk_score_ASD, color = risk_score_ASD)) + geom_jitter() + scale_color_gradientn(colours = rainbow(12)) + ggtitle("Jitter Plot of Alcohol Use During Pregnancy and Child's ASD Risk Score") + labs(y = "Child's Risk Score for ASD", x = "Number of Trimesters Alcohol Was Used", caption = "Figure 4.2.3") + theme(plot.title = element_text(hjust = 0.5, size = 12), plot.caption = element_text(face = "italic", hjust = 1))
```
.\par
Figure 4.2.2 is based on a mother's vaping habit and Figure 4.2.3 is based in a mother's drinking habit. Drinking was more popular than vaping during pregnancy. So, it was a bit concerning that the data did not have many mothers who vaped.

```{r, warning=FALSE, message=FALSE, echo=FALSE, fig.width=7}
ggplot(predata1, aes(x = tri_cannabis, y = risk_score_ASD, color = risk_score_ASD)) + geom_jitter() + scale_color_gradientn(colours = rainbow(12)) + ggtitle("Jitter Plot of Cannabis Use During Pregnancy and Child's ASD Risk Score") + labs(y = "Child's Risk Score for ASD", x = "Number of Trimesters Cannabis Was Used", caption = "Figure 4.2.4") + theme(plot.title = element_text(hjust = 0.5, size = 12), plot.caption = element_text(face = "italic", hjust = 1))

ggplot(predata1, aes(x = tri_stimulants, y = risk_score_ASD, color = risk_score_ASD)) + geom_jitter() + scale_color_gradientn(colours = rainbow(12)) + ggtitle("Jitter Plot of Stimulant Use During Pregnancy and Child's ASD Risk Score") + labs(y = "Child's Risk Score for ASD", x = "Number of Trimesters Stimulants Were Used", caption = "Figure 4.2.5") + theme(plot.title = element_text(hjust = 0.5, size = 12), plot.caption = element_text(face = "italic", hjust = 1))
```
.\par
Figure 4.2.4 is based on cannabis use and Figure 4.2.5 is based on stimulant use. A decent number of mothers used cannabis during pregnancy and not that many used stimulants.

```{r, warning=FALSE, message=FALSE, echo=FALSE, fig.width=7}
ggplot(predata1, aes(x = tri_opioids, y = risk_score_ASD, color = risk_score_ASD)) + geom_jitter() + scale_color_gradientn(colours = rainbow(12)) + ggtitle("Jitter Plot of Opioid Use During Pregnancy and Child's ASD Risk Score") + labs(y = "Child's Risk Score for ASD", x = "Number of Trimesters Opioids Were Used", caption = "Figure 4.2.6") + theme(plot.title = element_text(hjust = 0.5, size = 12), plot.caption = element_text(face = "italic", hjust = 1))

ggplot(predata1, aes(x = tri_psychoactives, y = risk_score_ASD, color = risk_score_ASD)) + geom_jitter() + scale_color_gradientn(colours = rainbow(12)) + ggtitle("Jitter Plot of Psychoactive Use During Pregnancy and Child's ASD Risk Score") + labs(y = "Child's Risk Score for ASD", x = "Number of Trimesters Psychoactives Were Used", caption = "Figure 4.2.7") + theme(plot.title = element_text(hjust = 0.5, size = 12), plot.caption = element_text(face = "italic", hjust = 1))
```
\setlength{\parindent}{4em}
\setlength{\parskip}{1em}
Finally, Figure 4.2.6 examines the use of opioids and Figure 4.2.7 examines the use of psychoactives. There were only around 18 mothers who used opioids and only 3 mothers who used psychoactives during pregnancy. Hence, there was not enough data present for these drugs to examine them for significance in our models.

## Controlling for Sex: 
.\par
The literature mentions that there are three contributers to sex differences in ASD rates: biologically driven differences, gender socialization, and limited research and measurement tools. Fundamentally, young girls  with ASD have proven to achieve more basic milestones on time compared to boys. They have overall better social skills and better peer relationships, which disrupts the typical bias and norms set in the standards for ASD. A recent study by the Children’s National Health Systems shows that in current diagnostic practices, in order for females to have an ASD diagnosis they must present more concurrent behavioral, developmental or mental health issues, compared to their male counterparts. A significant factor that plays into these modern discrepancies is that most of the research and testing done on figuring out diagnosis and symptoms of ASD was on a majority of male patients, so many of the benchmarks for the diagnosis will tend to follow that for males, rather than for females. Due to the overwhelming significance and differences highlighted in our outside research of gender and ASD diagnosis, we decided to talk a look if our very own data will follow the literature.

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(readr)
predata2 <- read_csv("predata.csv")
ggplot(predata2, aes(x = risk_score_ASD, fill = sex, color = sex)) + 
  geom_histogram(binwidth = 1) +
  facet_grid(sex ~ .) + 
  theme_bw() + 
  ggtitle("ASD risk score for Males vs. Females")
  
```
\setlength{\parindent}{4em}
\setlength{\parskip}{1em}

The boxplot above did not follow our expectations at first because it appears that there is no significant difference of the means of the risk scores between males and females. However, it is important to note that the NA’s likely play a significant role in these outputs. Moreover, we can see that there tends to be more frequent high risk scores for males as opposed to females, so when we run our final models it is still worth looking into the significance that sex will have on determining the factors of ASD. 



\section{Statistical analysis used to answer the research questions}
.\par
  A random forest model was run on prenatal factors to determine which variables were important risk factors for `risk_score_ASD`. Highly correlated variables were dropped from the data before running the random forest model because having too many variables containing similar information will result in inaccurate importance measures due to a model weighing too much on one set of related variables compared to another set of variables. Important variables were determined from the node purity and mean squared error measures. From these measures, 14 total variables were selected as important risk factors from `risk_score_ASD` to be included in our final model. \par
   Poisson regression was used to model the response variable, `risk_score_ASD` which consists of “count data”. Three models were created including one full model, one model controlling for males, and one model controlling for females. A Poisson Model was chosen for our statistical analysis rather than a negative binomial model, which also handles count data, since the dispersion parameter for all three models was less than one, indicating the variance for each model was less than the expected value for each model. Assumptions of this model also include independence of observations and the distribution of counts following a Poisson distribution. The AIC measures for all three models also indicate that the models controlling by gender fit the data better than the full model. In particular, the female model appears to fit the data the best due to its small AIC value relative to the other two models. These AIC measures coincide with our literature review and EDA, where males and females have different risk factors associated with ASD risk score.
   

```{r echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
ggplot(predata2, aes(x = risk_score_ASD)) + geom_histogram(binwidth = 0.5, color = "black", fill = "light blue", aes(y = ..density..)) +
  theme_bw() +
  geom_density(alpha = 0.2, fill = "#FF6666") +
  ggtitle("Histogram of Risk Score ASD") + 
  scale_y_continuous(name = "Frequency") + 
  scale_x_continuous(name = "Risk Score")

```

   
   

```{r,echo=FALSE}
# library(readr)
# predata <- read_csv("~/Desktop/STATS 141SL/Final Project/predata.csv")
# library(randomForest)
# drops <- c("maternalpregnancyproblems___19", "maternalpregnancyproblems___20", "matmentalhealth___1", "matmentalhealth___2", "matmentalhealth___3","matmentalhealth___4", "matmentalhealth___5", "matmentalhealth___6", "matmentalhealth___7", "mat_dep", "mat_anx", "mat_ocd","mat_bp","mat_adhd","mat_pssd","maternalproblems1","art","momlivebirths","totalpregnancies","maternalpregnancyproblems___18","momfever")
# predata1 <- na.omit(predata[ , !(names(predata) %in% drops)])
# rf.pre <- randomForest(risk_score_ASD~.,data=predata1,mtry=16,importance=TRUE,ntrees=1000)
```

```{r,echo=FALSE,warning=FALSE,message=FALSE}
# library(randomForestExplainer)
# min_depth_frame <- min_depth_distribution(rf.pre)
# plot_min_depth_distribution(min_depth_frame, mean_sample = "relevant_trees", k = 15)

# controlling for Sex 
library(dplyr)
maledata <- predata %>% filter(sex == 1)
femaledata <- predata %>% filter(sex == 0)
```

\section{Summary of results}

```{r, echo=FALSE, message=FALSE, results='asis', warning=FALSE}
m1 <- glm(risk_score_ASD ~ momsdeliveryage+momsedu+delivery+babymortality + mathealth_count + sex+tri_alcohol+tri_tobacco+
mom_trauma+maternalpregnancyproblems___8+artmethod___1 +tri_vaping+deaf1+tri_cannabis, data = predata, family = "poisson")
m2 <- glm(risk_score_ASD ~ momsdeliveryage+momsedu+delivery+babymortality + mathealth_count + tri_alcohol+tri_tobacco+
mom_trauma+maternalpregnancyproblems___8+artmethod___1 +tri_vaping+deaf1+tri_cannabis, data = maledata, family = "poisson")
m3 <- glm(risk_score_ASD ~ momsdeliveryage+momsedu+delivery+babymortality + mathealth_count +tri_alcohol+tri_tobacco+
mom_trauma+maternalpregnancyproblems___8+artmethod___1 +tri_vaping+deaf1+tri_cannabis, data = femaledata, family = "poisson")
```

## Tables 
```{r, echo=FALSE}
library(xtable)
options(xtable.floating = FALSE)
options(xtable.timestamp = "")
```


### Predata Table 
```{r, echo=FALSE, message=FALSE, results='asis', warning=FALSE}
options(xtable.comment = FALSE)
xtable(m1)
```

### Predata Model Diagnostic Plots
```{r, echo=FALSE}
par(mfrow=c(2,2))
plot(m1)
```

### Maledata Table 

```{r, echo=FALSE, message=FALSE, results='asis', warning=FALSE}
options(xtable.comment = FALSE)
xtable(m2)
```

### Maledata Model Diagnostic Plots
```{r, echo=FALSE}
par(mfrow=c(2,2))
plot(m2)
```

### Femaledata Table 

```{r, echo=FALSE, message=FALSE, results='asis', warning=FALSE}
options(xtable.comment = FALSE)
xtable(m3)
```

### Femaledata Model Diagnostic Plots
```{r, echo=FALSE}
par(mfrow=c(2,2))
plot(m3)
```

\section{Interpretation of results}
\setlength{\parindent}{4em}
\setlength{\parskip}{1em}
.\par  

   By running a random forest on all of the prenatal variables we found that the significant risk factors that predispose a child to ASD behaviors are: `momsdeliveryage`, `momsedu`, `delivery`, `babymortality`, `mathealth_count`, `sex`, `tri_alcohol`, `tri_tobacco`, `mom_trauma`, `maternalpregnancyproblems___8`, `artmethod___1`, `tri_vaping`, `deaf1`, and `tri_cannabis`. These variables were chosen based on the mean of their minimal depth calculated from our random forest model. In conducting Poisson regression for three models, we used these variables. The first focused on answering our first posed research question  while the second and third models were driven towards answering our second research question. \par

   Our first model used the 14 predetermined variables and had four significant factors: mother’s education level, a count variable that we created consisting of how many mental health diagnoses the mother has, the sex of the child, and whether the child has more than one deaf family member. The p-values for these predictors are 0.02299, 0.00234, 0.01915, and 0.01774 respectively, which are all significant at a 0.01 alpha level. Based on these findings, we can see that a level increase in the mother’s education will increase a child’s risk score by a factor of 1.02. We also observed that each additional mental health diagnosis for the mother will decrease the risk score by a factor of 0.03. If a child is male, then the risk score will be increased by a factor of 1.04. Additionally, if a child has more than one deaf family member, then the child’s risk score will increase by a factor of 1.07. We were interested by the variables that were not statistically significant in our model as this seemed to be counterintuitive to literature that we had reviewed and our prior knowledge. \par

   Due to the signifcance of the variable ”sex” in our first model, we chose to control for gender in our next two models. Our second model had all of the variables present in the initial model without “sex” but focused on the impact of the gender being male on the statistically significant predictors. In this Poisson model, we saw two predictors significant at the 0.01 level, the number of mental health diagnoses for the mother and whether the child has more than one deaf family member with p-values of 0.0389 and 0.0260 respectively. One of our predictors, `maternalpregnancyproblems___8` which is coded as the mother having anemia, a condition in which the blood does not have enough oxygen to carry to the body’s tissues, was significant at the 0.05 level with a p-value of 0.0511. Based on our findings, an increase in mental health diagnoses for the mother decreases their child’s risk score by a factor of about 0.03, which is the same value that we observed in our model that did not control for gender. In this case, we can determine that the mental health score does not impact a child’s risk score if the child is a male. If the child has more than one deaf family member, their risk score increases by a factor of 1.09, which is slightly higher than our first model. This indicates that, on average, a male child will have a larger risk score if they have more than one deaf family member. If a male child has a mother that has anemia, then their risk score will decrease by a factor of about 0.08. In comparison to our first model, we observe that the variable for mother’s education is no longer significant with a p-value calculated of only 0.6389. \par

   For our third model, the data set was filtered by gender being female to focus on the impact of a baby’s gender and contained the variables from the first model, except for “sex.”  This model had the most statistically significant predictors with those being the mother’s education level, two of the delivery methods of the pregnancy those of which being planned and emergency C-section, the number of mental health diagnoses for the mother, the number of trimesters a mother used tobacco, and whether the mother had anemia during the pregnancy with p-values of 0.00531, 0.08332, 0.07570, 0.03819, 0.05802, and 0.01713 respectively. We can see that a level increase in the mother’s education will increase a child’s risk score by a factor of 1.04 given all else constant, which is slightly higher than our first model. A mother having delivered their baby through a planned C-section increases their child’s risk score by a factor of 1.06 while delivery through an emergency C-section increases this score by a factor of 1.07. These factors are statistically significant for this model only which controls for female children specifically.  Also, based on these findings, an increase in mental health diagnoses for the mother decreases their child’s risk score by a factor of about 0.03, which is the same value that we observed in our first model. In this case, we can determine that the mental health score does not impact a child’s risk score based on gender as this value is the same for male and female children. We can also see that for an increase in the number of trimesters that a mother used tobacco, their child’s risk score decreases by a factor of 0.07. Lastly, if a mother had anemia during their pregnancy, their child’s risk score will increase by a factor of 1.1. 


\section{Interpretation of plots}
.\par 
  Before interpreting the plots, it is important that we know what we are looking for in our analysis. For a poisson regression model, it is important we check if the mean and variances are equal by looking at the dispersion parameter. Using the msme function in the `msme` library, we can see that we do not need to worry about this since the dispersion for all three of our models is less than one. If we were to see a large difference, we would account for using a negative binomial regression model, however our in depth data cleaning took care of that assumption. Next, we want to look at the independence of variables - due to the in-depth cleaning of variables and analysis of correlation, we already expect this assumption to be met, however taking a look at the summary plots of our models will confirm this. Finally, we would like to check for linearity in our models. 


```{r echo=FALSE, warning=FALSE, message=FALSE}
library(msme)
# If the dispersion (P < 1), then the model fits the data well, underdispersion:
p1 <- 0.7981416 # P__disp(m1)[2]
p2 <- 0.7480804 # P__disp(m2)[2]
p3 <- 0.8358594 # P__disp(m3)[2]
a1 <- AIC(m1) # 9885.705
a2 <- AIC(m2) # 5164.465
a3 <- AIC(m3) # 4718.472

df <- data.frame(dispersion = c(p1, p2, p3), AIC = c(a1, a2, a3), model = c(1, 2, 3))
ggplot(df, aes(x = model, y = dispersion, fill = AIC)) + 
  geom_point(shape = 21, size = 4) + 
  theme_bw() + 
  scale_y_continuous(name = "Dispersion Parameter") + 
  scale_x_continuous(name = "Model", breaks = c(1,2,3)) + 
  ggtitle("Dispersion Parameters and Model Accuracy")

```



\section{Overall conclusions}
\setlength{\parindent}{4em}
\setlength{\parskip}{1em}
.\par 

   This study was quite informative in discerning which risk factors are statistically significant in predisposing children to ASD behaviors and if a statistically significant difference exists when looking at predictors for autism in males and females. In order to effectively discern the answers to these questions, we look at all three models: one for all children, one for males, and one for females. As mentioned in the interpretation of results section above, we discovered that mother’s education level, a count variable that we created consisting of how many mental health diagnoses the mother has, the sex of the child, and whether the child has more than one deaf family member were all statistically significant in the full model. Meanwhile for males the number of mental health diagnoses for the mother, whether the child has more than one deaf family member, and the mother having anemia were statistically significant while for females mother’s education level, two of the delivery methods of the pregnancy those of which being planned and emergency C-section, the number of mental health diagnoses for the mother, the number of trimesters a mother used tobacco, and whether the mother had anemia during the pregnancy were statistically significant. These findings show that the models point to diverging risk factors for ASD behaviors between males and females. Clearly, then, there is a statistically significant difference when looking at predictors for autism in males and females. \par
   
   Using the understanding acquired by modeling the sexes both together and separate, we are then able to come to a more informed conclusion about the statistically significant risk factors that predispose a child to ASD behaviors.  Specifically notable among the commonalities for predictors amongst males and females was the presence of statistical significance for both number of mental health diagnoses for the mother and whether or not the mother had anemia during pregnancy. As such, we can conclude that these factors are major risk factors that predispose a child to ASD behaviors, with number of mental health diagnoses for the mother being of extreme importance given that it was a statistically significant factor in the full model as well. Additionally, whether the child has more than one deaf family member was also present as a statistically significant factor in both the full model and the model with just males and also mother’s education level is a significant factor in both the full and female models, so these factors are notable as major risk factors as well. Some factors appeared in only one of the models, and thus are statistically significant risk factors but weigh less heavily than the factors in multiple models with regards to predisposition of a child to ASD behaviors. These factors are two of the delivery methods of the pregnancy (those of which  being planned and emergency C-section) and the number of trimesters a mother used tobacco. \par
   
   While we found statistical significance in all the aformentioned cases, it is important to note that these differences may not be of practical significance. Some of these risk factors present themselves as only minor contributiors to an individual's risk of developing autism. As such, determining which factors are truly practically significant should be assessed based on the specific needs of an individual project using this data.

\section{Challenges of the study}
.\par 
  Many of the challenges we faced during this project occurred when cleaning the dataset. These challenges included determining how to handle NAs, sifting through the `other` variables, finding variables with small counts, removing outliers, and addressing collinearity among variables. In dealing with NAs, we either removed observations with NAs in prenatal columns that we were interested in or set the NAs to 0 (particularly when the variable of interest was binary). Cleaning the ‘other’ columns proved to be very time consuming with a variety of responses present in these columns. Responses were either categorized into existing columns, combined to create new columns if enough similar responses were found, or removed due to obvious inconsistencies. Outliers were determined by looking at the summary statistics of the columns. Outliers with a large number of NAs and inconsistencies of columns such as mother’s age and number of live births were removed. Collinearity was dealt with by plotting correlation plots between variables and either completely removing one variable or combining highly correlated variables to make a new measure. It should be noted that implications involving collinearity, including its effect on the precision of estimates may be due to an unrepresentative sample or insufficient information in the sample [2]. Another challenge unrelated to cleaning the dataset was converting binary columns and non-numeric variables to factors. All of our variables were type “double” so after running a couple models and getting strange results, we solved this issue by converting binary/categorical variables to type “factor”. \par 
  
  Some of the challenges that we encountered during this project were not solved. These unsolvable challenges occured when testing the prediction accuracy of our model. Our models all had a high test error rate and our predictions of the response only ranged from 5 to 7. The actual response variable of `risk_score_ASD` had a range of 1 to 12 with a median of 6, so these results did not match our expectations. We got these results despite checking and meeting the assumptions of our model and are not entirely sure why our poisson model did a poor job predicting our response. Another challenge we faced was that our findings from our literature review did not match our actual findings after running the model. Variables such as `asd’ (number of family members with asd) and ‘mat_pssd` (whether or not mom has psychosis, schizophrenia, or schizoaffective disorder) were not significant, while `momsedu` was highly significant across all three models. Even after running a random forest model to select for important variables to include in our model to refine our model to only including 14 prenatal factors, all three models only had 2 to 3 statistically significant variables. \par 
  Overall, challenges that involved cleaning the survey data and converting column types to reflect the type of variable being measured were worked through and solvable issues. Challenges that involved testing the prediction accuracy of our model and some of the findings were unsolvable something to further explore in future work.


\section{Recommendations for the future}
\setlength{\parindent}{4em}
\setlength{\parskip}{0.5em}
.\par

  In the future, we recommend that other risk factors occurring at different times in a mother’s life be explored. In our work, we narrowed the scope of our research question by only exploring prenatal risk factors. We recommend that additional models and analysis be done on postnatal risk factors and their effect on `risk_score_ASD`. Additional analysis could be done on the delivery method and its effect on the autism risk score. According to our models, having a cesarean section significantly increases the risk score for autism. It would be interesting to explore the reasons for having a cesarean section, whether it was planned, due to prolonged labor, abnormal positioning, cord prolapse, etc. and see if any of these effects are significant risk factors for autism. \par 
  
  We also recommend changing some aspects of the survey in order to simplify the data cleaning process. Many of the `other` columns that we cleaned ended up being discarded due to low counts. We recommend that maternal health problems be condensed to include specific categories that you would want to study. This would mean possibly getting rid of some of the fill in “other” options on the survey. In addition, a lot of collinearity between variables were present, so there could be additional condensing of survey questions/variables to avoid these associations.
  
\newpage

\setlength{\parindent}{-4em}
\setlength{\parskip}{1em}

\section{Bibliography}
.\par

“Autism and Gender.” Autism Support - Leading UK Charity - National Autistic Society, www.autism.org.uk/about/what-is/gender.aspx.

“Autism spectrum disorder.” Mayo Clinic, 6 Jan. 2018, www.mayoclinic.org/diseases-conditions/autism-spectrum-disorder/symptoms-causes/syc-20352928.

Geelhand, Philippine, et al. “The Role of Gender in the Perception of Autism Symptom Severity and Future Behavioral Development.” Molecular Autism, 2019, www.molecularautism.biomedcentral.com.

Halladay, Alycia K, et al. “Sex and Gender Differences in Autism Spectrum Disorder: Summarizing Evidence Gaps and Identifying Emerging Areas of Priority.” Molecular Autism, BioMed Central, 13 June 2015, www.ncbi.nlm.nih.gov/pmc/articles/PMC4465158/.

“Poisson Regression Analysis Using SPSS Statistics.” How to Perform a Poisson Regression Analysis in SPSS Statistics | Laerd Statistics, statistics.laerd.com/spss-tutorials/poisson-regression-using-spss-statistics.php.

Vatcheva, Kristina P, et al. “Multicollinearity in Regression Analyses Conducted in Epidemiologic Studies.” Epidemiology (Sunnyvale, Calif.), U.S. National Library of Medicine, Apr. 2016, www.ncbi.nlm.nih.gov/pmc/articles/PMC4888898/.
